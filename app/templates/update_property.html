{% extends 'base.html' %} {% load widget_tweaks %} {% load static %}
<! ignore prettier ->

{% block content %}
<section class="container-fluid" id="main">
  <div class="container-fluid w-75 p-3">
    <h1 class="text-center display-2 pb-3">Update</h1>
    <div class="card p-2 bg-warning-subtle">
      <form
        method="post"
        class="bg-warning-subtle"
        enctype="multipart/form-data"
      >
        {% csrf_token %}
        <div class="mb-3">
          <div class="row mb-2">
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >Address</label
                >
                {% render_field property_form.address class="form-control" %}
              </div>
            </div>
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >City</label
                >
                {% render_field property_form.city class="form-control" %}
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >Price</label
                >

                {% render_field property_form.price class="form-control" %}
              </div>
            </div>
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >Square Footage</label
                >
                {% render_field property_form.squareFoot class="form-control" %}
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >Bedrooms</label
                >
                {% render_field property_form.bedrooms class="form-control" %}
              </div>
            </div>
            <div class="col">
              <div class="form_field">
                <label for="exampleFormControlInput1" class="form-label"
                  >Baths</label
                >
                {% render_field property_form.bathrooms class="form-control" %}
              </div>
            </div>
          </div>
          <div class="form_field pt-2">
            <label for="exampleFormControlInput1" class="form-label"
              >Pet Friendly</label
            >
            {% render_field property_form.isPetFriendly type="checkbox" %}
          </div>
          <div class="form_field">
            <label for="exampleFormControlInput1" class="form-label"
              >Description</label
            >
            {% render_field property_form.description class="form-control" %}
          </div>
          <div class="form-field">
            <label>Existing Images:</label>

            {% for form in property_photo_formset %}
            <! ignore prettier ->
            {% if form.instance.picture %}
            <div class="existing-image">
              <img src="{{ form.instance.picture.url }}" alt="Property Photo" />
            </div>
            {% endif %} {% endfor %}
          </div>

          <!-- File Upload -->
          <div class="form-field pt-2">
            <label>Upload New Images:</label>
            {% for form in property_photo_formset %}
            <div class="file-upload-container">{{ form.picture }}</div>
            {% endfor %}
          </div>
        </div>
        <button class="btn btn-success" type="submit">Update</button>
        <a class="btn btn-warning" href="{% url 'home' %}">Cancel</a>
      </form>
    </div>
  </div>
</section>

{% comment %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const addImageButton = document.getElementById("add_image");
    addImageButton.addEventListener("click", function () {
      const formsetContainer = document.querySelector(".formset-container");
      const totalFormsInput = document.getElementById("id_form-TOTAL_FORMS");
      const newFormIndex = parseInt(totalFormsInput.value);
      const formPrefix = "form";
      const formHtml = `
        <div class="form_field">
          <label for="${formPrefix}-${newFormIndex}-photo">Photo</label>
          <input type="file" name="${formPrefix}-${newFormIndex}-photo" required id="${formPrefix}-${newFormIndex}-photo">
        </div>
      `;
      formsetContainer.insertAdjacentHTML("beforeend", formHtml);
      totalFormsInput.value = newFormIndex + 1;
    });
  });
</script>
{% endcomment %} {% endblock content %}
