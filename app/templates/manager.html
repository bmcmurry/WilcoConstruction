{% extends 'base.html' %} {% load static %} {% block content %}
<! ignore prettier ->
<section class="overflow-hidden">
  {% comment %} {% include 'create_property.html' %}

  <a href="{% url 'search_property' %}">
    <button type="button" class="btn btn-warning mb-3 ms-5">Search</button></a
  >{% endcomment %}
  <h1 class="text-center display-2 mt-3">Manager Interface</h1>
  <div class="row p-2">
    <div class="col-lg-12 col-xl-6 mb-2 overflow-auto">
      <div class="card card-body">
        <input type="search" class="form-control" id="datatable-search-input" />
        <label class="form-label" for="datatable-search-input"
          >Search Properties</label
        >
        <div class="table-responsive">
          <table class="table table-sm">
            <tr>
              <th>Address</th>
              <th>Occupied</th>
              <th>Tenant</th>
              <th>Bedrooms</th>
              <th>Bathrooms</th>
            </tr>
            {% for property in properties %}
            <tr>
              <td>{{ property.address }}</td>
              <td>{{ property.isRented }}</td>
              {% if property.isRented %} {% for tenant in tenants %}
              <! ignore prettier ->
              {% if tenant.linkToLease.linkToProperty == property %}
              <td>{{ tenant }}</td>
              <! ignore prettier ->
              {% endif %} {% endfor %} {% else %}
              <td>N/A</td>
              {% endif %}
              <td>{{ property.bedrooms }}</td>
              <td>{{ property.bathrooms }}</td>
              <td>
                <a href="{% url 'update_property' property.id %}"
                  ><i class="bi bi-pencil-square"></i
                ></a>
              </td>
              {% if property.isFeaturedProperty == False %}
              <td>
                <a href="{% url 'delete_property' property.id %}">
                  <i class="bi bi-trash3-fill text-danger"></i
                ></a>
              </td>
              <td>
                <a href="{% url 'feature_property' property.id %}"
                  ><i class="bi bi-bookmark-star-fill text-warning"></i
                ></a>
              </td>
              {% endif %}
            </tr>
            {% endfor %}
          </table>
        </div>
        <div>
          <a href="{% url 'create_property' %}" class="btn btn-warning"
            >Add Property</a
          >
        </div>
      </div>
    </div>
    <div class="col-lg-12 col-xl-6 overflow-auto">
      <div class="card card-body">
        <input type="search" class="form-control" id="datatable-search-input" />
        <label class="form-label" for="datatable-search-input"
          >Search Leases</label
        >
        <div class="table-responsive">
          <table class="table table-sm">
            <tr>
              <th>Name</th>
              <th>Property</th>
              <th>Monthly Price</th>
              <th>Balance</th>
              <th>Length</th>
              <th>More Info</th>
            </tr>
            {% for lease in leases %}
            <tr>
              <td>
                {% for tenant in lease.tenant_set.all %} {{ tenant.first_name }}
                {{ tenant.last_name }}<br />
                {% endfor %}
              </td>
              <td>{{ lease.linkToProperty }}</td>
              <td>{{ lease.pricePerMonth }}</td>
              <td>{{ lease.currentBalance }}</td>
              <td>{{ lease.numOfMonths }} Months</td>

              <!-- Button trigger modal -->
              <td>
                <i
                  class="bi bi-info-square-fill text-info"
                  data-bs-toggle="modal"
                  data-bs-target="#{{ lease.id }}"
                ></i>

                <div
                  class="modal fade modal-lg"
                  id="{{ lease.id }}"
                  tabindex="-1"
                  aria-labelledby="exampleModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header bg-warning">
                        <h3>{{ lease.linkToProperty }}</h3>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        <p class="card-text">
                          Address: {{ lease.linkToProperty }}
                        </p>
                        {% for tenant in lease.tenant_set.all %}
                        <p class="card-text">Name: {{ tenant }}</p>
                        {% if tenant.phone %}
                        <p class="card-text">Phone: {{ tenant.phone }}</p>
                        {% endif %}
                        <p class="card-text">Email: {{ tenant.userEmail }}</p>
                        <hr />
                        {% endfor %}
                        <p class="card-text">
                          Balance: {{ lease.currentBalance }}
                        </p>
                        <p class="card-text">
                          Date Created: {{ lease.dateCreated }}
                        </p>
                      </div>
                      <div class="modal-footer bg-warning">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Close
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </table>
        </div>
        <div>
          <a href="{% url 'create_lease' %}" class="btn btn-warning"
            >Create Lease</a
          >
        </div>
      </div>
    </div>
    <div class="col-lg-12 col-xl-6 mb-2 overflow-auto">
      <div class="card card-body">
        <input type="search" class="form-control" id="datatable-search-input" />
        <label class="form-label" for="datatable-search-input"
          >Search Construction Jobs</label
        >
        <div class="table-responsive">
          <table class="table table-sm">
            <tr>
              <th>Title</th>
              <th>Completed</th>
              <th>Start Date</th>
            </tr>
            {% for job in construction %}
            <tr>
              <td>{{ job.title }}</td>
              <td>{{ job.isComplete }}</td>
              <td>{{ job.dateCreated }}</td>
              <td>
                <a href="{% url 'update_construction' job.id %}"
                  ><i class="bi bi-pencil-square"></i
                ></a>
              </td>
              {% if job.isFeaturedConstruction == False %}
              <td>
                <a href="{% url 'delete_construction' job.id %}">
                  <i class="bi bi-trash3-fill text-danger"></i
                ></a>
              </td>
              <td>
                <a href="{% url 'feature_construction' job.id %}"
                  ><i class="bi bi-bookmark-star-fill text-warning"></i
                ></a>
              </td>
              {% endif %}
            </tr>
            {% endfor %}
          </table>
        </div>
        <div>
          <a href="{% url 'create_construction' %}" class="btn btn-warning"
            >Add Construction Job</a
          >
        </div>
      </div>
    </div>
    {% comment %}
    <div class="form-outline mb-4">
      <input type="search" class="form-control" id="datatable-search-input" />
      <label class="form-label" for="datatable-search-input">Search</label>
    </div>
    {% endcomment %} {% comment %}
    <div id="datatable"></div>
    {% endcomment %}
  </div>
</section>

{% endblock %}
